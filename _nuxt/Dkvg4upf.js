var st=Object.defineProperty;var it=(i,t,s)=>t in i?st(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var d=(i,t,s)=>it(i,typeof t!="symbol"?t+"":t,s);import{i as rt,am as nt,P as ot,a8 as at,an as ct,_ as lt,H as ut,j as L,l as E,f as ht,D as dt,M as k,c as z,o as $,a as mt,F as ft,z as pt,d as U,A as R,X as gt,s as _,E as yt,u as vt}from"./MXlv4cO2.js";import{t as F,u as J,a as wt}from"./C2RDFc8i.js";import{u as xt}from"./R4B9MUw-.js";function _t(i){return new URL(window.location.href)}const At=rt({name:"HydrationWrapper",setup(i,{slots:t}){const s=t.default?t.default():[];return()=>St(s)}}),St=i=>i.length===1?i[0]:i,H=["avif","webp","png","jpg","gif"],Bt="jpg",$t=i=>{const{pathname:t}=at(i),n=(ct(t,{strict:!1})||"").match(/\.([^.]+)$/),e=n?n[1]:"";return e&&H.includes(e)||H.includes(e)?e:Bt};async function Mt(i,t,s){window.Image?i=i.modify({src:t}):i=i.modify({src:ot(t)?t:nt(t,_t().origin)});const{width:n,height:e}=await s.getImageSize(i.src);return i.modify({width:n,height:e})}class M{constructor({src:t,sizes:s,width:n,height:e,media:r="all",quality:m=70,format:f=void 0,preload:a=!1,modifiers:l={},provider:u=void 0,preset:o=void 0,densities:h=void 0}){d(this,"src");d(this,"media");d(this,"sizes");d(this,"width");d(this,"height");d(this,"format");d(this,"quality");d(this,"preload");d(this,"modifiers");d(this,"provider");d(this,"preset");d(this,"densities");this.src=t,this.sizes=s,this.media=r,this.width=n,this.height=e,this.format=Nt(t,f),this.quality=m,this.preload=a||!1,this.modifiers=l,this.provider=u,this.preset=o,this.densities=h}get key(){return F(JSON.stringify(this.toJSON()))}get ratio(){return(this.width??0)/(this.height??0)}get className(){return`image-${F(Q(this.src))}`}get style(){return`
      @supports (aspect-ratio: 1) {
        @media ${this.media} { .${this.className} { aspect-ratio: ${this.width} / ${this.height}; } }
      }
    `}getModifiers(){return{...this.modifiers,format:this.format,quality:this.quality}}getOptions(t){return{provider:this.provider,preset:this.preset,densities:this.densities||t.densities}}getMeta(t,s){return Mt(new M({...this.toJSON()}),t,s)}getPreload(t,s,n){return{rel:"preload",as:"image",imagesrcset:t,imagesizes:s,media:this.media,crossorigin:n}}modify(t){return new M({...this.toJSON(),...t})}toJSON(){return{src:this.src,sizes:this.sizes,media:this.media,width:this.width,height:this.height,format:this.format,quality:this.quality,preload:this.preload,modifiers:this.modifiers,provider:this.provider,preset:this.preset,densities:this.densities}}static create(...t){return new this(...t)}}function Nt(i,t){const s=$t(i);return t!=null&&t.includes(s)?s:t||s}function Q(i){if(i.startsWith("/"))return i;const t=new URL(i);return t.pathname+t.search+t.hash}const q=/(!?\(\s*min(-device)?-width)(.|\n)+\(\s*max(-device)?-width|\(\s*width\s*>(=)?(.|\n)+\(\s*width\s*<(=)?|(!?\(.*<(=)?\s*width\s*<(=)?)/i,Ft=/\(\s*min(-device)?-width|\(\s*width\s*>(=)?/i,D=/(!?\(\s*max(-device)?-width)(.|\n)+\(\s*min(-device)?-width|\(\s*width\s*<(=)?(.|\n)+\(\s*width\s*>(=)?|(!?\(.*>(=)?\s*width\s*>(=)?)/i,Pt=/\(\s*max(-device)?-width|\(\s*width\s*<(=)?/i,v=N(q,D,Ft),A=N(D,q,Pt),V=/(!?\(\s*min(-device)?-height)(.|\n)+\(\s*max(-device)?-height|\(\s*height\s*>(=)?(.|\n)+\(\s*height\s*<(=)?|(!?\(.*<(=)?\s*height\s*<(=)?)/i,Ct=/\(\s*min(-device)?-height|\(\s*height\s*>(=)?/i,X=/(!?\(\s*max(-device)?-height)(.|\n)+\(\s*min(-device)?-height|\(\s*height\s*<(=)?(.|\n)+\(\s*height\s*>(=)?|(!?\(.*>(=)?\s*height\s*>(=)?)/i,Ot=/\(\s*max(-device)?-height|\(\s*height\s*<(=)?/i,w=N(V,X,Ct),S=N(X,V,Ot),g=/<(?!=)/,y=/>(?!=)/,I=/print/i,T=/^print$/i,p=Number.MAX_VALUE;function B(i){let t=/(-?\d*\.?\d+)(ch|em|ex|px|rem)/.exec(i);if(t===null&&(v(i)||w(i))&&(t=/(\d)/.exec(i)),t==="0")return 0;if(t===null)return p;let s=t[1];switch(t[2]){case"ch":s=parseFloat(s)*8.8984375;break;case"em":case"rem":s=parseFloat(s)*16;break;case"ex":s=parseFloat(s)*8.296875;break;case"px":s=parseFloat(s);break}return+s}function N(i,t,s){return function(n){let e;return i.test(n)?e=!0:t.test(n)?e=!1:e=s.test(n),n.includes("not")?!e:e}}function W(i,t){const s=I.test(i),n=T.test(i),e=I.test(t),r=T.test(t);return s&&e?!n&&r?1:n&&!r?-1:i.localeCompare(t):s?1:e?-1:null}function Lt(i){const s={}.unitlessMqAlwaysFirst;function n(e,r){const m=W(e,r);if(m!==null)return m;const f=v(e)||w(e),a=A(e)||S(e),l=v(r)||w(r),u=A(r)||S(r);if(s&&(!f&&!a||!l&&!u))return!f&&!a&&!l&&!u?e.localeCompare(r):!l&&!u?1:-1;{if(f&&u)return-1;if(a&&l)return 1;const o=B(e),h=B(r);if(o===p&&h===p)return e.localeCompare(r);if(o===p)return 1;if(h===p)return-1;if(o>h)return a?-1:1;if(o<h)return a?1:-1;if(o===h){if(a&&u){if(g.test(e)&&!g.test(r))return 1;if(!g.test(e)&&g.test(r))return-1}if(f&&l){if(y.test(e)&&!y.test(r))return 1;if(!y.test(e)&&y.test(r))return-1}}return e.localeCompare(r)}}return n.desktopFirst=function(e,r){const m=W(e,r);if(m!==null)return m;const f=v(e)||w(e),a=A(e)||S(e),l=v(r)||w(r),u=A(r)||S(r);if(s&&(!f&&!a||!l&&!u))return!f&&!a&&!l&&!u?e.localeCompare(r):!l&&!u?1:-1;{if(f&&u)return 1;if(a&&l)return-1;const o=B(e),h=B(r);if(o===p&&h===p)return e.localeCompare(r);if(o===p)return 1;if(h===p)return-1;if(o>h)return a?-1:1;if(o<h)return a?1:-1;if(o===h){if(a&&u){if(g.test(e)&&!g.test(r))return 1;if(!g.test(e)&&g.test(r))return-1}if(f&&l){if(y.test(e)&&!y.test(r))return 1;if(!y.test(e)&&y.test(r))return-1}}return-e.localeCompare(r)}},n}const kt=Lt();class P{constructor(t,s={}){d(this,"list",[]);d(this,"sort",!1);s=s||{},this.sort=s.sort||!1,this.list=this.list.concat(Array.from(t||this.list).map(n=>new M(n)))}get length(){return this.list.length}[Symbol.iterator](){return this.list.values()}get key(){return this.list.map(t=>t.key).join("-")}get sorted(){return this.sort?this.list.sort((t,s)=>kt(t.media||"",s.media||"")):this.list}get style(){return this.list.map(({media:t,width:s,height:n,style:e})=>`
      @media ${t} { .${this.className}::before { padding-top: calc((1 / (${s} / ${n})) * 100%); } }
      @supports (aspect-ratio: 1) {
        @media ${t} { .${this.className} { aspect-ratio: ${s} / ${n}; } }
      }
      ${e}
    `).reverse().join(" ")}get className(){return`picture-${F(this.sorted.map(({src:t})=>Q(t)).join(","))}`}get classNames(){return{picture:this.className,image:this.list.map(t=>t.className)}}getFormats(t,s,n){return this.sorted.reduce((e,r)=>e.concat(t.map(m=>r.modify({format:m,preload:m.includes(s)&&n}))),[])}async getMeta(t,s){const n=await Promise.all(this.sorted.map(e=>{const r=t.getSizes(e.src,{sizes:e.sizes,modifiers:e.getModifiers(),...e.getOptions(s)});return r.src?e.getMeta(r.src,s):(console.warn("No src found for source",e),e)}).filter(Boolean));return new P(n)}toJSON(){return this.list}static create(...t){return new this(...t)}}function zt(i){return["anonymous","use-credentials",void 0].includes(i)}const Y={sources:{type:Array,default(){return[]}},formats:{type:Array,default(){return null}},title:{type:String,default:null},alt:{type:String,default:null},crossorigin:{type:[Boolean,String],default(){return null},validator:zt},sortSources:{type:Boolean,default:!0}},Rt={__name:"Base",props:Y,emits:["load"],async setup(i,{emit:t}){let s,n;const e=["avif","webp","png","jpg","gif"],r=i,m=t,{isCritical:f}=J(),a=xt(),l=ut().$booster,u=P.create(r.sources,{sort:r.sortSources}),o=L(),h=r.formats||l.targetFormats,G=Array.from(new Set(e.map(c=>h.find(x=>x.includes(c))))).filter(Boolean),K=e.find(c=>h.find(x=>x.includes(c))),Z=L(u.getFormats(G,K,f.value)),C=E(()=>{var c;return((c=o.value)==null?void 0:c.classNames)||{picture:"",image:[]}}),b=c=>{m("load",c)};ht(()=>{if(o.value&&o.value.length){const c=o.value.classNames;return{style:[wt(o.value,c)]}}return{}});try{o.value=([s,n]=dt(()=>u.getMeta(a,l)),s=await s,n(),s)}catch(c){console.error(c)}return(c,x)=>{const tt=k("picture-source"),et=k("base-image");return $(),z("picture",{class:R([C.value.picture,"nuxt-booster-picture"])},[($(!0),z(ft,null,pt(Z.value,O=>($(),U(tt,{key:O.key,source:O,crossorigin:c.crossorigin},null,8,["source","crossorigin"]))),128)),mt(et,{class:R(C.value.image),title:c.title,alt:c.alt,crossorigin:c.crossorigin,width:"0",height:"0",onLoad:b},null,8,["class","title","alt","crossorigin"])],2)}}},j=lt(Rt,[["__scopeId","data-v-e37e6d74"]]),jt={__name:"BoosterPicture",props:{hydrate:{type:Boolean,default:!0},...Y},setup(i){const t=i,s=gt(),{isCritical:n}=J(),e=E(()=>t.hydrate?_(j,{...s,...t,hydrate:void 0,critical:n.value}):_(At,{},[_("noscript",{class:"nuxt-booster-picture-noscript"},[_(j,{...s,...t,hydrate:void 0,critical:t.hydrate})])]));return(r,m)=>($(),U(yt(vt(e))))}};export{jt as _};
